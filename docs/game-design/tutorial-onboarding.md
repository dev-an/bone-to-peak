# 튜토리얼 & 온보딩 시스템

> [← 기획 총괄로 돌아가기](./overview.md)

---

## 개요

Bone-To-Peak은 여러 시스템(소환, 합성, 폭발, 포메이션)이 복합적으로 작동하는 게임이다. 튜토리얼은 이 시스템들을 **플레이하면서 자연스럽게 학습**하도록 설계한다. 별도의 튜토리얼 모드가 아닌, **첫 런의 웨이브 진행**에 맞춰 단계적으로 안내한다.

---

## 설계 원칙

1. **실전 학습**: 별도 튜토리얼 씬 없이, 첫 번째 런에서 실시간으로 안내
2. **최소 개입**: 전체 화면을 가리지 않는 소형 팝업으로 안내
3. **스킵 가능**: 모든 안내는 ESC 또는 "건너뛰기" 버튼으로 즉시 스킵
4. **반복 없음**: 한 번 표시된 튜토리얼은 다시 표시되지 않음 (설정에서 초기화 가능)
5. **점진적 해금**: 복잡한 시스템은 해당 웨이브에 도달할 때까지 UI에서 숨김

---

## 첫 런 튜토리얼 흐름

### Phase 1: 기본 조작 (Wave 1 시작 전)

| 순서 | 안내 내용                   | 트리거         | UI 형태                |
| ---- | --------------------------- | -------------- | ---------------------- |
| 1    | "WASD로 이동하라"           | 런 시작 즉시   | 화면 하단 팝업         |
| 2    | "좌클릭으로 공격"           | 첫 이동 후 2초 | 마우스 아이콘 + 화살표 |
| 3    | "적을 처치하고 시체를 수집" | 첫 적 스폰 시  | 적 위에 화살표 표시    |

### Phase 2: 소환 시스템 (Wave 1 중)

| 순서 | 안내 내용                           | 트리거                | UI 형태                 |
| ---- | ----------------------------------- | --------------------- | ----------------------- |
| 4    | "녹색 시체를 주워라"                | 첫 적 처치 시         | Corpse 위에 강조 이펙트 |
| 5    | "우클릭으로 미니언 소환"            | Corpse 첫 수집 시     | 우클릭 아이콘 + 팝업    |
| 6    | "미니언이 자동으로 싸운다"          | 첫 미니언 소환 시     | 미니언 위에 "!" 표시    |
| 7    | "소환 슬롯 0/3 — 더 소환할 수 있다" | 슬롯에 여유가 있을 때 | 슬롯 UI 하이라이트      |

### Phase 3: 전투 심화 (Wave 2~3)

| 순서 | 안내 내용                         | 트리거         | UI 형태             |
| ---- | --------------------------------- | -------------- | ------------------- |
| 8    | "다양한 적이 등장한다 — 주의하라" | Wave 2 시작 시 | 웨이브 배너 아래 팁 |
| 9    | "미니언이 네크로맨서를 보호한다"  | 첫 피격 시     | 방어 관련 팁 팝업   |
| 10   | "레벨업! 3개 중 하나를 선택하라"  | 첫 레벨업 시   | 카드 UI 위에 안내   |

### Phase 4: 고급 시스템 (Wave 3~5)

| 순서 | 안내 내용                              | 트리거           | UI 형태              |
| ---- | -------------------------------------- | ---------------- | -------------------- |
| 11   | "Q 키로 포메이션 전환 — 상황에 맞게"   | Wave 3 시작 시   | Q 키 아이콘 팝업     |
| 12   | "Space로 미니언 합성 — 더 강한 미니언" | Refine 해금 시   | Space 키 아이콘 팝업 |
| 13   | "E 키로 시체 폭발 — 위기 탈출용"       | Explode 해금 시  | E 키 아이콘 팝업     |
| 14   | "⚠ 보스가 접근 중!"                    | Wave 5 보스 등장 | 화면 중앙 경고       |

---

## 팝업 UI 디자인

### 팝업 유형

```
1. 소형 팝업 (대부분의 안내)
┌─────────────────────────────┐
│ 💀 우클릭으로 미니언 소환  │
│            [확인] [건너뛰기] │
└─────────────────────────────┘
위치: 화면 하단 중앙
크기: 400×60 px
게임 일시정지: 아니오

2. 키 안내 팝업 (입력 관련)
┌───────────────────────┐
│  [Q] 포메이션 전환    │
│  현재: Phalanx        │
│  → Charge → Circular  │
└───────────────────────┘
위치: 해당 HUD 요소 근처
크기: 300×80 px
게임 일시정지: 아니오

3. 시스템 해금 팝업 (새 시스템 등장)
┌─────────────────────────────────┐
│        ✦ 새 기능 해금 ✦        │
│                                 │
│   합성 (Refine)                │
│   Space 키로 미니언을 합성하여 │
│   더 강한 미니언을 만들어라    │
│                                 │
│         [확인] [자세히]         │
└─────────────────────────────────┘
위치: 화면 중앙
크기: 500×200 px
게임 일시정지: 예 (2초간 또는 확인 클릭까지)
```

---

## 시스템 해금 가시성

첫 런에서 아직 해금되지 않은 시스템의 HUD 요소는 **숨김 처리**한다.

| 시스템      | 해금 전 HUD 상태              | 해금 후 HUD 상태        |
| ----------- | ----------------------------- | ----------------------- |
| 포메이션    | 좌하단 포메이션 표시 없음     | 표시 + 안내 팝업        |
| Explode     | 우하단 Explode 쿨타임 없음    | 표시 + 안내 팝업        |
| Refine      | Space 키 바인딩 비활성        | 활성 + 안내 팝업        |
| 소환 휠     | 우클릭 = 마지막 미니언만 소환 | 길게 누르기 활성 + 안내 |
| 미니언 해제 | Tab 메뉴에 해제 버튼 없음     | Wave 5 이후 활성        |

---

## 인게임 팁 시스템

튜토리얼과 별도로, **상황 기반 팁**이 웨이브 간 휴식 시간에 표시된다.

### 팁 표시 규칙

| 항목      | 값                                           |
| --------- | -------------------------------------------- |
| 표시 위치 | 화면 하단 중앙, 웨이브 간 휴식 시간에만 표시 |
| 표시 시간 | 5초간 표시 후 자동 페이드 아웃               |
| 표시 빈도 | 웨이브 간 휴식마다 1개                       |
| 중복 방지 | 한 런에서 같은 팁은 표시되지 않음            |
| 설정      | "인게임 팁 표시" 토글로 끄기 가능            |

### 상황 기반 팁 예시

| 조건                             | 팁 내용                                                      |
| -------------------------------- | ------------------------------------------------------------ |
| 소환 슬롯이 가득 차 있음         | "미니언 해제(Tab)로 슬롯을 확보할 수 있다"                   |
| Corpse 수용량이 3회 연속 가득 참 | "Corpse를 소환이나 합성에 사용하여 공간을 확보하라"          |
| 미니언이 3마리 이상 사망         | "Defensive Phalanx로 미니언 생존력을 높여라"                 |
| 포메이션을 한 번도 전환하지 않음 | "Q 키로 포메이션을 전환해보라 — 상황에 맞는 진형이 중요하다" |
| Explode를 한 번도 사용하지 않음  | "E 키 Explode는 포위 상황에서 탈출할 수 있는 비상 수단이다"  |
| 합성 가능한 미니언 조합이 있음   | "Space 키로 미니언을 합성하여 더 강한 미니언을 만들어라"     |
| 보스전 직전 (Wave 4 종료 시)     | "보스가 접근 중 — Circular Guard로 전방위 방어를 준비하라"   |

---

## 튜토리얼 데이터 관리

| 항목         | 방식                                             |
| ------------ | ------------------------------------------------ |
| 진행 저장    | `PlayerPrefs` `Tutorial_{StepID}_Shown` (bool)   |
| 팁 표시 기록 | `PlayerPrefs` `Tip_{TipID}_Shown` (bool, 런별)   |
| 전체 초기화  | 설정 → "튜토리얼 초기화" 버튼 (모든 단계 재표시) |
| 스킵 모드    | 설정 → "튜토리얼 표시" 토글 (OFF 시 모두 숨김)   |

---

## 재방문 플레이어 고려

| 상황                     | 동작                                      |
| ------------------------ | ----------------------------------------- |
| 첫 런이 아닌 경우        | 모든 튜토리얼 팝업 표시 안 함             |
| 메타 강화를 구매한 경우  | 이미 첫 런을 경험한 것으로 간주           |
| 오랜만에 복귀 (7일 이상) | "복귀 팁" 1회 표시: 주요 조작법 요약 카드 |
| 새 바이옴 첫 방문        | 바이옴 고유 효과 안내 팝업 1회 표시       |
| 새 Ascension 첫 시도     | Ascension 특수 규칙 안내 팝업 1회 표시    |

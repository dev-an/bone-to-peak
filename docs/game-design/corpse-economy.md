# 시체 경제 시스템

> [← 기획 총괄로 돌아가기](./overview.md)

---

## 개요

Corpse(시체)는 Bone-To-Peak의 핵심 자원이다. 적을 처치하면 시체가 드롭되며, 이를 수집하여 **소환(Raise)**, **합성(Refine)**, **폭발(Explode)** 세 가지 방법으로 활용한다. 자원의 사용처를 선택하는 판단이 게임의 전략적 깊이를 만든다.

---

## Corpse 획득

### 적 처치 드롭

| 적 유형     | 드롭량 | 비고                       |
| ----------- | ------ | -------------------------- |
| 일반 근접   | 1      | 가장 흔한 자원 공급원      |
| 일반 원거리 | 1      |                            |
| 탱크형      | 2      | 체력이 높은 대신 보상 증가 |
| 엘리트      | 3      | 웨이브 중 소수 등장        |
| 보스        | 10     | 대량 확보 기회             |

### 필드 수집

- 적 처치 시 시체는 **바닥에 잠시 남아있다** (5초간 유지)
- 네크로맨서가 시체 위를 지나가면 **자동 수집**
- 수집 범위는 기본 1.5 유닛, 스킬로 확장 가능
- Corpse 수용량 초과 시 수집 불가 (초과분은 바닥에 유지)

### Corpse 오브젝트 상세

| 항목 | 값 | 설명 |
| --- | --- | --- |
| 바닥 유지 시간 | 5초 | 시간 초과 시 소멸 |
| 소멸 경고 | 마지막 1.5초 | 깜빡임 연출 시작 |
| 수집 범위 | 1.5 유닛 (기본) | 스킬로 최대 4.0까지 확장 |
| 수집 흡입 속도 | 10 유닛/초 | 범위 진입 시 네크로맨서 방향으로 빨려 들어옴 |
| 시각 표현 | 녹색 해골 아이콘 | 크기: 0.5 × 0.5 유닛 |
| 바닥 겹침 | 최대 5개 스택 | 같은 위치에 여러 Corpse 표시 시 숫자 뱃지 |

- Corpse는 물리 충돌 없음 (다른 오브젝트를 통과)
- 여러 마리를 같은 위치에서 처치하면 Corpse가 약간 흩어져 드롭 (반경 0.5 유닛)

### Corpse 수용량

| 기본값 | 최대 (강화 후) |
| ------ | -------------- |
| 10     | 30             |

> 수용량 증가는 [성장 시스템](./progression-system.md)의 레벨업 선택지로 획득한다.

### 수용량 초과 시 동작

- 수용량이 가득 차면 HUD의 Corpse 카운터가 **붉은색으로 점등**
- 바닥의 Corpse는 수집되지 않고 남아있으며, 5초 유지 타이머는 계속 진행
- 소환/폭발로 Corpse를 소비하면 즉시 주변 Corpse 자동 수집 재개

---

## Raise — 소환

Corpse를 소비하여 [미니언](./minion-system.md)을 소환한다.

### 소환 비용 테이블

| 미니언          | 티어 | Corpse 비용 |
| --------------- | ---- | ----------- |
| 스켈레톤 워리어 | T1   | 1           |
| 좀비            | T1   | 1           |
| 스켈레톤 아처   | T1   | 2           |
| 그래브 나이트   | T2   | 3           |
| 레이스          | T2   | 4           |
| 본 골렘         | T2   | 5           |

### 소환 규칙

- [소환 슬롯](./player-necromancer.md)이 있어야 소환 가능
- 소환 쿨타임 적용 (기본 2초)
- 같은 종류의 미니언을 연속 소환 가능

### Raise 효율 분석

| 전략 | Corpse 10개로 가능한 조합 | 총 DPS (근사) | 총 HP |
| --- | --- | --- | --- |
| T1 물량 | 스켈레톤 워리어 ×10 | 120 | 300 |
| T1 혼합 | 워리어 ×4 + 아처 ×3 | 68 | 180 |
| T2 정예 | 그래브 나이트 ×2 + 레이스 ×1 | 42.5 | 240 |
| T1→T2 합성 | 워리어 ×4 → 그래브 나이트 ×2 (추가 Corpse 4) | 30 | 200 |

> DPS = 공격력 ÷ 공격속도. T1 물량이 순수 DPS에서 우세하지만, T2는 생존력과 특수 능력에서 보상됨.

---

## Refine — 합성

약한 미니언을 조합하여 더 강한 미니언으로 합성한다. 추가 Corpse가 필요할 수 있다.

### 합성 조합 테이블

| 결과               | 재료                       | 추가 Corpse | 소요 시간 |
| ------------------ | -------------------------- | ----------- | --------- |
| 그래브 나이트 (T2) | 스켈레톤 워리어 ×2         | 2           | 1.5초     |
| 레이스 (T2)        | 스켈레톤 아처 ×2           | 3           | 1.5초     |
| 본 골렘 (T2)       | 좀비 ×3                    | 3           | 2.0초     |
| 데스 나이트 (T3)   | 그래브 나이트 + 레이스     | 5           | 3.0초     |
| 본 드래곤 (T3)     | 본 골렘 + 스켈레톤 아처 ×3 | 8           | 3.0초     |
| 리치 (T3)          | 레이스 ×2                  | 10          | 4.0초     |

### 합성 규칙

- Space 키를 눌러 합성 메뉴 진입
- 재료 미니언은 **현재 소환된 상태**여야 함
- 합성 중에는 재료 미니언이 **움직이지 않음** (취약 시간)
- 합성이 완료되면 재료 미니언이 사라지고 결과 미니언이 등장
- 합성 중 네크로맨서가 피격당하면 합성 **취소** (재료는 보존, 추가 Corpse도 반환)
- 합성으로 생성된 미니언은 재료의 소환 슬롯을 재사용 (T3는 슬롯 2개 차지)

### Refine 효율 분석

직접 Raise와 Refine 경로의 비용 비교.

| 결과 미니언 | 직접 Raise 비용 | Refine 총 비용 | 차이 | 비고 |
| --- | --- | --- | --- | --- |
| 그래브 나이트 (T2) | Corpse 3 | Corpse 4 (워리어 ×2 + 추가 2) | +1 | Refine이 약간 비싸지만 슬롯 1개 절약 |
| 레이스 (T2) | Corpse 4 | Corpse 7 (아처 ×2 + 추가 3) | +3 | 직접 Raise가 효율적 |
| 본 골렘 (T2) | Corpse 5 | Corpse 6 (좀비 ×3 + 추가 3) | +1 | 비슷한 효율 |
| 데스 나이트 (T3) | 직접 Raise 불가 | Corpse 12 (나이트 3 + 레이스 4 + 추가 5) | — | Refine 전용 |
| 본 드래곤 (T3) | 직접 Raise 불가 | Corpse 19 (골렘 5 + 아처 ×3 6 + 추가 8) | — | Refine 전용 |
| 리치 (T3) | 직접 Raise 불가 | Corpse 18 (레이스 ×2 8 + 추가 10) | — | Refine 전용 |

> **설계 의도**: T2는 "직접 Raise"와 "Refine" 모두 가능하게 하되, 직접 Raise가 Corpse 효율에서 약간 유리하다. 그러나 Refine은 소환 슬롯을 절약하므로, 슬롯이 부족할 때 가치가 높아진다.

### Refine UI 흐름

```
Space 입력
    │
    ▼
합성 메뉴 (현재 소환된 미니언 목록 표시)
    │
    ├── 조합 가능한 미니언 조합 하이라이트
    │       │
    │       ▼
    │   재료 미니언 선택 (클릭 or 마우스 오버)
    │       │
    │       ▼
    │   결과 미리보기 (결과 미니언 + 필요 추가 Corpse)
    │       │
    │       ▼
    │   확인 (Space) → 합성 시작 (게임 진행 중, 일시정지 아님)
    │
    └── ESC → 합성 메뉴 닫기
```

- 합성 메뉴는 게임을 **일시정지하지 않음** (실시간 판단 요구)
- 합성 가능한 조합만 활성화, 불가능한 조합은 회색 처리
- 합성 진행 중 화면에 프로그레스 바 표시

---

## Explode — 시체 폭발

보유 중인 Corpse를 소비하여 범위 폭발을 일으킨다. 위기 탈출용 긴급 수단이다.

### 기본 스펙

| 항목          | 값                                       |
| ------------- | ---------------------------------------- |
| Corpse 소비량 | 사용한 만큼 (최소 1, 최대 보유량 전체)   |
| 기본 데미지   | Corpse 1개당 25                          |
| 폭발 반경     | 기본 3 유닛 + Corpse 1개당 0.3 유닛 추가 |
| 쿨타임        | 8초                                      |
| 최대 데미지   | 30개 × 25 = 750 (수용량 최대 강화 시)    |

### 사용 방법

- E 키를 짧게 누르면 **Corpse 전량** 사용
- E 키를 길게 누르면 게이지가 차오르며, 놓는 시점의 게이지에 해당하는 양만 사용
- 폭발은 네크로맨서 위치 중심으로 발생
- 아군 미니언에게는 피해 없음 (아군 피해 없음)

### Explode 피해 분포

거리에 따라 피해가 감소한다.

```
       폭발 중심 (네크로맨서 위치)
              ●
            / | \
 100% 피해  ─ 1 유닛 ─  내부 범위
  70% 피해  ─ 2 유닛 ─  중간 범위
  40% 피해  ─ 3 유닛 ─  외부 범위 (기본 최대)
  ... Corpse 추가분으로 외부 범위 확장 ...
```

| 거리 구간 | 피해 배율 |
| --- | --- |
| 0~1 유닛 | ×1.0 (100%) |
| 1~2 유닛 | ×0.7 (70%) |
| 2 유닛~최대 | ×0.4 (40%) |

### Explode 시나리오 예시

| 상황 | Corpse 사용 | 데미지 (중심) | 반경 | 판단 |
| --- | --- | --- | --- | --- |
| 긴급 탈출 | 3 | 75 | 3.9 유닛 | 스웜 5마리 정도 처리, 도주 공간 확보 |
| 중간 위기 | 7 | 175 | 5.1 유닛 | 할버디어급까지 일소 가능 |
| 풀 폭발 | 10 | 250 | 6.0 유닛 | 엘리트 제외 대부분 처리 |
| 최대 강화 풀 폭발 | 30 | 750 | 12.0 유닛 | 화면 대부분 커버, 비상시에만 사용 |

### Explode 특수 상호작용

- 바닥에 있는 **미수집 Corpse 위에서 폭발**하면, 해당 Corpse도 추가 폭발에 포함 (연쇄 폭발)
  - 연쇄 폭발 데미지: 바닥 Corpse 1개당 15 (본 폭발보다 약함)
  - 연쇄 폭발 반경: 바닥 Corpse 위치 중심 2 유닛
- 보스에게는 Explode 피해가 **70%만 적용** (보스 내성)

---

## 자원 밸런스 원칙

### 핵심 딜레마

플레이어는 항상 **소환 vs 합성 vs 폭발** 사이에서 선택해야 한다.

```
          Corpse 10개 보유 시 선택지
         ┌──────────────────────────┐
         │                          │
    소환 (Raise)              합성 (Refine)         폭발 (Explode)
  스켈레톤 ×10            데스 나이트 ×1           250 데미지 광역
  즉시 전력 보충           소수 정예 전환            긴급 탈출
         │                     │                      │
    물량 전략              정예 전략               생존 전략
```

### 밸런스 목표

1. **물량 vs 정예 균형**: T1 10마리와 T3 1마리의 총 전투력이 비슷하도록 조정
2. **Explode는 비상용**: 일반적으로 소환/합성이 더 효율적이지만, 포위 상황에서 Explode가 유일한 탈출구
3. **Corpse 부족 상태 유지**: 항상 Corpse가 약간 부족하게 느껴지도록 드롭률 조정 → 의미 있는 선택 강제
4. **후반 스케일링**: 웨이브가 진행될수록 적 드롭량이 증가하여 더 큰 규모의 운영 가능

---

## 웨이브별 자원 흐름 시뮬레이션

플레이어가 Corpse를 전부 수집한다고 가정한 이론적 자원 흐름이다. 실제로는 바닥 유지 시간 5초, 수용량 상한, 수집 위치 등으로 인해 **60~80% 수집률**이 현실적이다.

### 웨이브 1 (스웜 30마리)

```
수입: Corpse 30 (스웜 ×30, 드롭 1씩)
수집 가능: ~20 (수용량 10 기준, 2사이클)
지출 예상:
  - Raise: 스켈레톤 워리어 ×3 (Corpse 3)  → 슬롯 3/3
  - 잔여: ~17 (수용량 초과분은 바닥 소멸)
```

**웨이브 1 종료 시 상태**: 미니언 3마리, Corpse 수용량 부족 체감 시작

### 웨이브 3 (혼합 50마리)

```
수입: Corpse ~55 (스웜 + 할버디어 + 궁수)
수집 가능: ~35 (수용량 10~15, 3~4사이클)
지출 예상:
  - Raise: 혼합 미니언 ×5 (Corpse 8)  → 슬롯 5~6/5~6
  - Refine 해금 (첫 합성 시도 가능)
  - 잔여: ~10
```

**웨이브 3 종료 시 상태**: 미니언 5~6마리, Refine 첫 시도, Corpse 관리 판단 시작

### 웨이브 5 (보스 웨이브)

```
수입: Corpse ~75 (일반 60마리 + 보스 10)
수집 가능: ~50
지출 예상:
  - Raise: ×3 (Corpse 5)
  - Refine: T2 ×1 (Corpse 4~7)
  - Explode: 위기 시 Corpse 5~10
  - 잔여: ~15
```

**웨이브 5 종료 시 상태**: 미니언 7~8마리 (T2 1~2마리 포함), Explode 첫 사용

### 웨이브 10 (2차 보스)

```
수입: Corpse ~140 (일반 120마리 + 보스 10 + 엘리트 ×3)
수집 가능: ~90 (수용량 15~20 예상)
지출 예상:
  - Raise: ×5 (Corpse 10)
  - Refine: T3 ×1 (Corpse 15~20)
  - Explode: ×1~2 (Corpse 10~15)
  - 잔여: ~20
```

**웨이브 10 종료 시 상태**: 미니언 10~12마리 (T3 1마리 포함), 본격적 군단 운영

### 웨이브 20 (최종)

```
수입: Corpse ~400+ (대규모 웨이브)
수집 가능: ~250 (수용량 25~30)
지출: 지속적 Raise + Refine + 다수 Explode
```

**웨이브 20 상태**: 미니언 12~15마리 (T3 2~3마리), 모든 시스템 최대 활용

### 자원 흐름 요약 그래프 (텍스트)

```
Corpse 수입/지출 추이

수입  ▕████                              Wave 1  (~30)
      ▕██████████                        Wave 5  (~75)
      ▕██████████████████                Wave 10 (~140)
      ▕████████████████████████████████  Wave 20 (~400)

지출  ▕██                                Wave 1  (Raise만)
      ▕██████████                        Wave 5  (Raise + Explode)
      ▕████████████████                  Wave 10 (Raise + Refine + Explode)
      ▕██████████████████████████████    Wave 20 (전 시스템 최대)
```

> **핵심**: 수입과 지출이 항상 비슷하게 유지되어야 한다. 수입이 지출을 크게 초과하면 자원 선택의 의미가 사라지고, 지출이 수입을 크게 초과하면 좌절감을 준다. **수입 ≈ 지출 × 1.2** (약간의 여유)를 목표로 튜닝한다.

# 플레이어(네크로맨서) 시스템

> [← 기획 총괄로 돌아가기](./overview.md)

---

## 캐릭터 콘셉트

네크로맨서는 직접 전투보다 **언데드 군단의 지휘**에 특화된 캐릭터다. 자체 전투력은 약하지만, 시체를 자원으로 활용하여 미니언을 소환하고 강화하는 능력을 가진다.

---

## 기본 스탯

| 스탯                            | 초기값 | 설명                            |
| ------------------------------- | ------ | ------------------------------- |
| 체력 (HP)                       | 100    | 0이 되면 게임 오버              |
| 이동속도 (Move Speed)           | 5.0    | 기본 이동 속도                  |
| 소환 슬롯 (Summon Slots)        | 3      | 동시 소환 가능한 미니언 최대 수 |
| Corpse 수용량 (Corpse Capacity) | 10     | 보유 가능한 시체 자원 상한      |
| 소환 쿨타임 (Summon Cooldown)   | 2.0초  | 소환 행동 간 대기 시간          |
| 방어력 (Defense)                | 0      | 받는 피해 감소량 (고정값)       |

> 모든 스탯은 레벨업과 스킬을 통해 강화할 수 있다. 자세한 내용은 [성장 시스템](./progression-system.md)을 참고한다.

### 스탯 상한

| 스탯          | 최소값 | 최대값 | 비고                      |
| ------------- | ------ | ------ | ------------------------- |
| HP            | 100    | 300    | 메타 강화 + 인게임 합산   |
| 이동속도      | 5.0    | 8.0    | 속도 캡 초과 시 무시      |
| 소환 슬롯     | 3      | 15     | T3 미니언은 슬롯 2개 차지 |
| Corpse 수용량 | 10     | 30     |                           |
| 소환 쿨타임   | 2.0초  | 0.5초  | 최소값 = 최대 강화 상태   |
| 방어력        | 0      | 20     |                           |

### 데미지 계산 공식

```
실제 피해 = max(1, 적 공격력 - 방어력)
```

- 방어력이 아무리 높아도 최소 1 피해는 받음
- 방어력은 고정값 감소 (퍼센트 감소 아님)
- 피해 계산은 미니언에게도 동일하게 적용 (미니언 방어력은 포메이션 보너스로만 획득)

---

## 이동 메카닉

### 기본 이동

| 항목        | 값     | 설명                                 |
| ----------- | ------ | ------------------------------------ |
| 가속 시간   | 0.1초  | 정지 → 최고 속도까지 걸리는 시간     |
| 감속 시간   | 0.05초 | 입력 해제 후 정지까지 걸리는 시간    |
| 대각선 보정 | ×0.707 | `normalize()` 적용, 대각선 가속 방지 |

- 거의 즉각적인 반응 (Survivors 장르 표준)
- 이동 중에도 모든 행동(공격, 소환, Explode) 가능
- 벽/장애물 충돌 시 슬라이딩 처리 (벽에 붙어 멈추지 않음)

### 넉백

- 네크로맨서는 적에게 피격 시 **넉백 없음** (플레이어 조작감 보호)
- 해골 지팡이(근접 공격)로 적에게 넉백 부여 가능 (1.5 유닛)

---

## 조작법

### 이동

| 입력  | 동작            |
| ----- | --------------- |
| W / ↑ | 위로 이동       |
| A / ← | 왼쪽으로 이동   |
| S / ↓ | 아래로 이동     |
| D / → | 오른쪽으로 이동 |

- 8방향 이동 지원
- 대각선 이동 시 속도 정규화 적용

### 전투 & 소환

| 입력        | 동작                       |
| ----------- | -------------------------- |
| 마우스 커서 | 조준 방향                  |
| 좌클릭      | 기본 공격                  |
| 우클릭      | 소환 (Raise)               |
| Q           | 포메이션 전환              |
| E           | Corpse Explode (시체 폭발) |
| Space       | Refine (미니언 합성)       |

### UI & 시스템

| 입력 | 동작                    |
| ---- | ----------------------- |
| Tab  | 미니언 목록 / 군단 정보 |
| ESC  | 일시정지 메뉴           |

---

## 기본 공격

네크로맨서는 보조적인 자체 공격 수단을 가진다. 직접 전투는 약하지만, 초반 시체 확보와 긴급 상황 대응에 사용한다.

### 공격 옵션 (런 시작 시 선택)

| 타입               | 설명                        | 데미지 | 사거리 | 공격속도 |
| ------------------ | --------------------------- | ------ | ------ | -------- |
| 해골 지팡이 (근접) | 전방 휘두르기, 넉백 효과    | 15     | 짧음   | 1.0초    |
| 영혼 화살 (원거리) | 마우스 방향으로 투사체 발사 | 10     | 긺     | 0.8초    |

- 런 시작 시 둘 중 하나를 선택
- 레벨업으로 강화 가능하나, 미니언 강화 대비 효율이 낮음
- 기본 공격의 주 목적은 **초반 첫 시체 확보**

### 해골 지팡이 상세

```
       히트박스 (전방 90도 부채꼴)
          ╱ · · ╲
        ╱ · · · · ╲
      P─────────────→   사거리: 1.8 유닛
        ╲ · · · · ╱
          ╲ · · ╱
```

| 항목        | 값                                             |
| ----------- | ---------------------------------------------- |
| 히트박스    | 전방 90도 부채꼴, 반경 1.8 유닛                |
| 넉백 거리   | 1.5 유닛                                       |
| 관통        | 무제한 (범위 내 모든 적 타격)                  |
| 애니메이션  | 0.3초 (선딜 0.1초 + 활성 0.15초 + 후딜 0.05초) |
| 레벨업 강화 | 데미지 +5/단계, 넉백 +0.5/단계 (최대 3단계)    |

- 근접 무기지만 범위 공격이므로 밀집 적 상대로 효율적
- 넉백으로 접근하는 적을 밀어내며 공간 확보 가능

### 영혼 화살 상세

```
    P ──── ● ──── ● ──── ● ────→   사거리: 8 유닛
           투사체 (0.8초 간격)
```

| 항목           | 값                                                |
| -------------- | ------------------------------------------------- |
| 투사체 속도    | 12 유닛/초                                        |
| 투사체 크기    | 0.3 × 0.3 유닛                                    |
| 관통           | 없음 (1회 적중 시 소멸)                           |
| 사거리         | 8 유닛 (도달 후 소멸)                             |
| 자동 조준 보정 | 마우스 방향 ±15도 내 가장 가까운 적에게 약한 유도 |
| 레벨업 강화    | 데미지 +3/단계, 관통 +1/단계 (최대 3단계)         |

- 안전 거리 유지 가능, 초반 카이팅에 유리
- 약한 자동 조준으로 초보자 접근성 확보

---

## 소환 인터페이스

### 소환 과정

```
Corpse 보유 확인
      │
      ▼
  우클릭 입력
      │
      ▼
소환 대상 선택 (언락된 미니언 목록)
      │
      ▼
  Corpse 소비 + 쿨타임 시작
      │
      ▼
  미니언 등장 (네크로맨서 주변)
```

### 소환 규칙

- **Corpse가 충분해야** 소환 가능 (미니언별 비용 상이, [시체 경제](./corpse-economy.md) 참고)
- **소환 슬롯에 여유**가 있어야 소환 가능
- 소환된 미니언은 네크로맨서 주변에 출현하며, 현재 [포메이션](./formation-system.md)에 따라 자동 배치
- 소환 슬롯은 **미니언 종류**가 아닌 **미니언 개체 수** 기준

### 퀵 소환

- 우클릭을 짧게 누르면 **마지막으로 소환한 미니언**을 즉시 소환
- 우클릭을 길게 누르면 **소환 휠 UI**가 나타나 미니언 종류 선택 가능

---

## 피격 & 생존

### 히트박스 & 피격 판정

| 항목                | 값                                 |
| ------------------- | ---------------------------------- |
| 네크로맨서 히트박스 | 원형, 반경 0.4 유닛                |
| 피격 판정 레이어    | Player (적의 공격만 해당)          |
| 접촉 피해 간격      | 0.5초 (같은 적에게 연속 피격 방지) |

### 피격 규칙

- 적에게 직접 접촉하면 피해를 받음
- 미니언이 네크로맨서와 적 사이에 있으면 미니언이 먼저 피격 (가드 역할)
- 피격 시 **무적 시간 0.5초** (화면 깜빡임 연출)
- 무적 시간 중에는 모든 피해 원천 무시 (접촉, 투사체, 장판 모두)

### 사망 처리

- 체력이 0이 되면 **즉시 게임 오버** (부활 없음, 로그라이크 특성)
- 사망 시 슬로모션 연출 (0.5초간 TimeScale 0.2)
- 런 결과 화면 표시: 생존 시간, 처치 수, 최대 미니언 수, 획득 네크로 코인
- 결과 화면에서 메타 강화 상점 또는 재시작 선택

---

## 레벨업 시 선택지 구조

경험치를 획득하여 레벨업하면, 3개의 선택지 중 하나를 고른다.

| 카테고리        | 예시                                               |
| --------------- | -------------------------------------------------- |
| 네크로맨서 강화 | 체력 +20, 이동속도 +0.5, Corpse 수용량 +5          |
| 소환 강화       | 소환 슬롯 +1, 소환 쿨타임 -0.3초, 새 미니언 해금   |
| 군단 버프       | 전체 미니언 공격력 +10%, 전체 미니언 이동속도 +15% |

> 상세 스킬 트리와 선택지 풀은 [성장 시스템](./progression-system.md)을 참고한다.

---

## HUD 레이아웃

```
┌─────────────────────────────────────────────────────┐
│  [HP ████████░░]  [Corpse: 7/10]    [Wave 3  2:15]  │
│                                                      │
│                                                      │
│                                                      │
│                                                      │
│                      (게임 화면)                      │
│                                                      │
│                                                      │
│                                                      │
│                                                      │
│  [Formation: Phalanx]           [Minions: 5/8]       │
│  [Q] 전환                      [Explode CD: 3s]     │
└─────────────────────────────────────────────────────┘
```

### HUD 요소 상세

| 위치        | 요소            | 설명                             |
| ----------- | --------------- | -------------------------------- |
| 좌상단      | HP 바           | 초록 → 노랑 → 빨강으로 색상 변화 |
| 좌상단      | Corpse 카운터   | 현재/최대, 수집 시 숫자 팝업     |
| 우상단      | 웨이브 & 타이머 | 현재 웨이브, 경과 시간           |
| 좌하단      | 포메이션 표시   | 현재 활성 포메이션, 전환 쿨타임  |
| 우하단      | 미니언 카운터   | 현재/최대 소환 슬롯              |
| 우하단      | Explode 쿨타임  | 사용 가능 시 아이콘 발광         |
| 중앙상단    | 보스 HP 바      | 보스 등장 시에만 표시            |
| 중앙        | 레벨업 선택지   | 레벨업 시 3개 카드 팝업          |
| 캐릭터 주변 | 경험치 링       | 네크로맨서 발 밑 원형 게이지     |

### 소환 휠 UI

우클릭 길게 누르면 네크로맨서 중심으로 방사형 메뉴가 표시된다.

```
           스켈레톤 아처
          (Corpse: 2)
              │
    좀비 ─────┼───── 그래브 나이트
  (Corpse: 1) │     (Corpse: 3)
              │
        스켈레톤 워리어
          (Corpse: 1)
```

- 마우스 방향으로 미니언 선택
- Corpse 부족 시 해당 항목 회색 처리
- 언락되지 않은 미니언은 자물쇠 아이콘
- 슬롯 부족 시 "슬롯 부족" 경고 표시

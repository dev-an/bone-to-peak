# 오디오 & 사운드 디자인

> [← 기획 총괄로 돌아가기](./overview.md)

---

## 개요

Bone-To-Peak의 오디오는 **다크 판타지 분위기**를 강화하고, 게임플레이 피드백을 명확하게 전달하는 데 집중한다. 사운드는 플레이어의 행동에 즉각 반응하여 타격감, 위험 인지, 성취감을 제공한다.

---

## BGM (배경 음악)

### 음악 구조

게임 상태에 따라 BGM이 **레이어 전환** 방식으로 자연스럽게 변화한다.

| 상태                | 음악 특성                                    | 템포      |
| ------------------- | -------------------------------------------- | --------- |
| 메인 메뉴           | 어두운 오케스트라, 코러스, 느린 리듬         | 느림      |
| 웨이브 초반 (1~4)   | 저음 앰비언스 + 가벼운 퍼커션                | 보통      |
| 웨이브 중반 (5~14)  | 현악 + 합창 추가, 긴장감 증가                | 빠름      |
| 웨이브 후반 (15~20) | 풀 오케스트라 + 전자음 혼합, 클라이맥스 빌드 | 매우 빠름 |
| 보스전              | 전용 보스 테마 (보스별 모티프)               | 빠름      |
| 웨이브 간 휴식      | 음악 볼륨 감소, 앰비언스만 유지              | 느림      |
| 엔드리스 모드       | 메인 테마 변주 + 점진적 디스토션 증가        | 가변      |
| 결과 화면           | 승리: 웅장한 팡파르 / 패배: 조용한 레퀴엠    | —         |

### 동적 음악 전환 규칙

```
레이어 구성:
  Layer 0: 앰비언스 (항상 재생)
  Layer 1: 리듬 베이스 (웨이브 시작 시 페이드 인)
  Layer 2: 멜로디 (웨이브 5+ 부터)
  Layer 3: 강화 퍼커션 (엘리트/보스 등장 시)
  Layer 4: 보스 전용 테마 (보스 HP 바 활성 시)

전환 방식:
  - 레이어 추가: 2초에 걸쳐 페이드 인
  - 레이어 제거: 3초에 걸쳐 페이드 아웃
  - 보스 테마: 1초 크로스페이드 (기존 BGM → 보스 테마)
  - 보스 처치: 1초 무음 → 3초에 걸쳐 기존 BGM 복귀
```

### 바이옴별 음악 변형

| 바이옴      | 악기 특성                      | 분위기 키워드  |
| ----------- | ------------------------------ | -------------- |
| 버려진 묘지 | 파이프 오르간, 하프, 합창      | 장엄, 쓸쓸     |
| 전쟁터 폐허 | 군악 드럼, 금관, 낮은 현악     | 전투적, 긴장   |
| 지하 묘소   | 합성 패드, 에코 피아노, 물방울 | 미스터리, 불안 |

---

## SFX (효과음)

### SFX 카테고리

#### 플레이어 액션

| 효과음             | 트리거               | 특성                      | 우선순위 |
| ------------------ | -------------------- | ------------------------- | -------- |
| 지팡이 휘두르기    | 좌클릭 (지팡이)      | 짧은 윈드 스윕            | 높음     |
| 영혼 화살 발사     | 좌클릭 (화살)        | 마법 윙 + 바람            | 높음     |
| 영혼 화살 적중     | 투사체 히트          | 에너지 임팩트             | 높음     |
| 소환 (Raise)       | 우클릭 소환          | 뼈 조립 + 마법 차임       | 높음     |
| 합성 시작 (Refine) | Space 합성 시작      | 마법진 활성화, 저음 윙    | 중간     |
| 합성 완료          | 합성 프로그레스 100% | 폭발적 마법 에너지 + 차임 | 높음     |
| 합성 취소          | 피격으로 합성 취소   | 유리 깨지는 소리          | 높음     |
| 폭발 (Explode)     | E 키                 | 저음 폭발 + 뼈 파편       | 최고     |
| 포메이션 전환      | Q 키                 | 군악 호른 짧은 신호음     | 중간     |
| 미니언 해제        | Tab → 해제           | 마법 소산, 약한 차임      | 낮음     |

#### 전투

| 효과음             | 트리거             | 특성                         | 우선순위 |
| ------------------ | ------------------ | ---------------------------- | -------- |
| 미니언 근접 공격   | 미니언 공격 적중   | 뼈 부딪힘 (짧고 가벼움)      | 중간     |
| 미니언 원거리 발사 | 아처/레이스 발사   | 화살: 윙 / 레이스: 에너지 윙 | 중간     |
| 적 피격            | 적 HP 감소         | 살점 임팩트 (부드러움)       | 중간     |
| 적 사망            | 적 HP 0            | 유형별 사망음                | 중간     |
| 플레이어 피격      | 네크로맨서 HP 감소 | 강한 임팩트 + 심장 박동      | 최고     |
| 보스 등장          | 보스 스폰          | 웅장한 임팩트 + 포효         | 최고     |
| 보스 페이즈 전환   | HP 구간 돌파       | 충격파 + 마법 에너지 폭발    | 최고     |

#### 자원 & UI

| 효과음           | 트리거           | 특성                      | 우선순위 |
| ---------------- | ---------------- | ------------------------- | -------- |
| Corpse 수집      | Corpse 흡입 완료 | 뼈 주머니 소리 (틱!)      | 낮음     |
| 경험치 수집      | XP 구슬 흡입     | 높은 음 차임 (틱틱)       | 낮음     |
| 레벨업           | 레벨 달성        | 팡파르 + 마법 차임        | 최고     |
| 레벨업 선택      | 카드 선택        | 카드 뒤집기 + 강화 효과음 | 높음     |
| 체력 회복 수집   | 회복 아이템 접촉 | 부드러운 힐링 차임        | 중간     |
| 수용량 초과 경고 | Corpse 가득 참   | 짧은 경고 비프            | 중간     |

#### 환경

| 효과음         | 트리거            | 특성                         |
| -------------- | ----------------- | ---------------------------- |
| 죽음의 안개    | 안개 영역 진입    | 윈드 + 속삭이는 목소리       |
| 오염된 웅덩이  | 웅덩이 영역 진입  | 기포 소리 + 독 지지직        |
| 네크로 원천    | 원천 위에 서 있음 | 부드러운 마법 공명 (반복)    |
| 뼈 제단 활성화 | Wave 10 도달      | 무거운 돌 움직임 + 불꽃 점화 |
| 장애물 파괴    | 중형 장애물 HP 0  | 돌 부서지는 소리             |

---

## 사운드 우선순위 시스템

동시에 재생되는 SFX가 많을 때, 우선순위에 따라 관리한다.

### 우선순위 레벨

| 레벨 | 설명             | 동시 재생 상한 | 예시                             |
| ---- | ---------------- | -------------- | -------------------------------- |
| 최고 | 게임 핵심 피드백 | 제한 없음      | 플레이어 피격, 보스 등장, 레벨업 |
| 높음 | 플레이어 액션    | 3              | 소환, 공격, 합성 완료            |
| 중간 | 전투 피드백      | 5              | 미니언 공격, 적 피격             |
| 낮음 | 부가 피드백      | 3              | 자원 수집, 환경음                |

### 사운드 인스턴스 풀링

- 동일 SFX가 짧은 시간(0.05초) 내에 다수 재생 요청 시, **첫 인스턴스만 재생** (중복 방지)
- 미니언 공격음은 동시에 최대 5개까지만 재생 (나머지 무시)
- 적 사망음은 0.1초 내 다수 발생 시 **하나의 강화된 사망음**으로 합침

---

## 볼륨 레이어

### 설정 가능한 볼륨 채널

| 채널     | 기본값 | 설명               |
| -------- | ------ | ------------------ |
| 마스터   | 100%   | 전체 볼륨          |
| BGM      | 70%    | 배경 음악          |
| SFX      | 100%   | 효과음             |
| 앰비언스 | 50%    | 환경 소리, 바람 등 |
| UI       | 80%    | 메뉴 효과음, 알림  |

### 동적 볼륨 조절 (Ducking)

| 상황                   | 조절                               |
| ---------------------- | ---------------------------------- |
| 보스 등장 SFX 재생     | BGM -40% (2초간) → 복귀            |
| 레벨업 UI 활성         | SFX -30%, BGM -20% (선택까지)      |
| Explode 발동           | 다른 SFX -50% (0.5초간)            |
| 합성 진행 중           | 앰비언스 -20% (합성 SFX 부각)      |
| 네크로맨서 HP 30% 이하 | 심장 박동 SFX 추가 + BGM 약간 왜곡 |

---

## 구현 고려사항

| 항목              | 방식                                          |
| ----------------- | --------------------------------------------- |
| 오디오 포맷       | SFX: OGG (가볍고 무손실), BGM: OGG (스트리밍) |
| 공간 오디오       | 2D 게임이므로 Stereo Pan만 사용 (좌우 위치)   |
| Pan 규칙          | 화면 좌측 적 = 좌 Pan, 우측 = 우 Pan          |
| 오디오 매니저     | 싱글톤 AudioManager, Object Pool 기반         |
| 대기 SFX 인스턴스 | 최소 20개 (피크 시 동시 SFX 다수)             |
